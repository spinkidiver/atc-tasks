{"ast":null,"code":"import { TaskRepositoryImpl } from \"@/app/task/infrastructure/repositories/TaskRepositoryImpl\";\nimport { StoreTaskUseCase, UpdateTaskUseCase } from \"@/app/task/usecases\";\nimport * as yup from \"yup\";\nimport { Form, Field, ErrorMessage } from \"vee-validate\";\nimport Task from \"@/app/task/domain/entities/Task\";\nexport default {\n  name: \"TaskForm\",\n  props: {\n    initialData: {\n      type: Object,\n      default: () => ({\n        name: \"\",\n        description: null,\n        status: \"low\",\n        completed: false,\n        expires_at: null,\n        id: null\n      })\n    }\n  },\n  data() {\n    return {\n      formData: {\n        ...this.initialData\n      },\n      loading: false,\n      error: null,\n      taskSchema: yup.object().shape({\n        name: yup.string().required(\"El nombre es obligatorio\"),\n        description: yup.string().nullable(),\n        status: yup.string().oneOf([\"low\", \"medium\", \"high\"]).default(\"low\"),\n        completed: yup.boolean().default(false),\n        expires_at: yup.date().nullable()\n      })\n    };\n  },\n  watch: {\n    initialData: {\n      deep: true,\n      handler(newVal) {\n        this.formData = {\n          ...newVal\n        };\n      }\n    }\n  },\n  methods: {\n    async onSubmit(values) {\n      try {\n        const taskData = new Task({\n          id: this.formData.id,\n          description: values.description,\n          active: values.active\n        });\n\n        // Attempts to coerce values to the correct type\n        let parsedData = this.taskSchema.cast(taskData, {\n          stripUnknown: true,\n          assert: true\n        });\n        const taskRepository = new TaskRepositoryImpl();\n        let response;\n        if (this.formData.id) {\n          // Actualizar tarea existente\n          const updateTaskUseCase = new UpdateTaskUseCase(taskRepository);\n          response = await updateTaskUseCase.execute(parsedData);\n          // this.$emit(\"task-updated\", response);\n        } else {\n          // Crear nueva tarea\n          const storeTaskUseCase = new StoreTaskUseCase(taskRepository);\n          response = await storeTaskUseCase.execute(parsedData);\n          // this.$emit(\"task-added\", response);\n        }\n        if (!response?.error) {\n          this.formData = {\n            name: \"\",\n            description: null,\n            status: \"low\",\n            completed: false,\n            expires_at: null,\n            id: null\n          };\n        }\n      } catch (err) {\n        console.error(\"Error al validar/guardar la tarea:\", err);\n        this.error = err.errors ? err.errors.join(\", \") : \"Hubo un error.\";\n      }\n    }\n  }\n};","map":{"version":3,"names":["TaskRepositoryImpl","StoreTaskUseCase","UpdateTaskUseCase","yup","Form","Field","ErrorMessage","Task","name","props","initialData","type","Object","default","description","status","completed","expires_at","id","data","formData","loading","error","taskSchema","object","shape","string","required","nullable","oneOf","boolean","date","watch","deep","handler","newVal","methods","onSubmit","values","taskData","active","parsedData","cast","stripUnknown","assert","taskRepository","response","updateTaskUseCase","execute","storeTaskUseCase","err","console","errors","join"],"sources":["src/app/task/interfaces/presentation/components/TaskForm.vue"],"sourcesContent":["<template>\n  <validation-observer v-slot=\"{ handleSubmit }\" ref=\"formValidator\">\n    <b-form role=\"form\" @submit.prevent=\"handleSubmit(handleLogin)\">\n      <base-input\n        alternative\n        class=\"mb-3\"\n        name=\"Email\"\n        :rules=\"{ required: true, email: true }\"\n        prepend-icon=\"ni ni-email-83\"\n        placeholder=\"Email\"\n        v-model=\"loginRequest.email\"\n      >\n      </base-input>\n\n      <base-input\n        alternative\n        class=\"mb-3\"\n        name=\"Password\"\n        :rules=\"{ required: true, min: 6 }\"\n        prepend-icon=\"ni ni-lock-circle-open\"\n        type=\"password\"\n        placeholder=\"Password\"\n        v-model=\"loginRequest.password\"\n      >\n      </base-input>\n\n      <div class=\"text-center\">\n        <base-button type=\"primary\" native-type=\"submit\" class=\"my-4\"\n          >Sign in</base-button\n        >\n      </div>\n    </b-form>\n  </validation-observer>\n</template>\n\n<script>\nimport { TaskRepositoryImpl } from \"@/app/task/infrastructure/repositories/TaskRepositoryImpl\";\nimport { StoreTaskUseCase, UpdateTaskUseCase } from \"@/app/task/usecases\";\nimport * as yup from \"yup\";\nimport { Form, Field, ErrorMessage } from \"vee-validate\";\nimport Task from \"@/app/task/domain/entities/Task\";\n\nexport default {\n  name: \"TaskForm\",\n\n  props: {\n    initialData: {\n      type: Object,\n      default: () => ({\n        name: \"\",\n        description: null,\n        status: \"low\",\n        completed: false,\n        expires_at: null,\n        id: null,\n      }),\n    },\n  },\n\n  data() {\n    return {\n      formData: { ...this.initialData },\n      loading: false,\n      error: null,\n      taskSchema: yup.object().shape({\n        name: yup.string().required(\"El nombre es obligatorio\"),\n        description: yup.string().nullable(),\n        status: yup.string().oneOf([\"low\", \"medium\", \"high\"]).default(\"low\"),\n        completed: yup.boolean().default(false),\n        expires_at: yup.date().nullable(),\n      }),\n    };\n  },\n\n  watch: {\n    initialData: {\n      deep: true,\n      handler(newVal) {\n        this.formData = { ...newVal };\n      },\n    },\n  },\n\n  methods: {\n    async onSubmit(values) {\n      try {\n        const taskData = new Task({\n          id: this.formData.id,\n          description: values.description,\n          active: values.active,\n        });\n\n        // Attempts to coerce values to the correct type\n        let parsedData = this.taskSchema.cast(taskData, {\n          stripUnknown: true,\n          assert: true,\n        });\n        const taskRepository = new TaskRepositoryImpl();\n        let response;\n\n        if (this.formData.id) {\n          // Actualizar tarea existente\n          const updateTaskUseCase = new UpdateTaskUseCase(taskRepository);\n          response = await updateTaskUseCase.execute(parsedData);\n          // this.$emit(\"task-updated\", response);\n        } else {\n          // Crear nueva tarea\n          const storeTaskUseCase = new StoreTaskUseCase(taskRepository);\n          response = await storeTaskUseCase.execute(parsedData);\n          // this.$emit(\"task-added\", response);\n        }\n\n        if (!response?.error) {\n          this.formData = {\n            name: \"\",\n            description: null,\n            status: \"low\",\n            completed: false,\n            expires_at: null,\n            id: null,\n          };\n        }\n      } catch (err) {\n        console.error(\"Error al validar/guardar la tarea:\", err);\n        this.error = err.errors ? err.errors.join(\", \") : \"Hubo un error.\";\n      }\n    },\n  },\n};\n</script>\n"],"mappings":"AAoCA,SAAAA,kBAAA;AACA,SAAAC,gBAAA,EAAAC,iBAAA;AACA,YAAAC,GAAA;AACA,SAAAC,IAAA,EAAAC,KAAA,EAAAC,YAAA;AACA,OAAAC,IAAA;AAEA;EACAC,IAAA;EAEAC,KAAA;IACAC,WAAA;MACAC,IAAA,EAAAC,MAAA;MACAC,OAAA,EAAAA,CAAA;QACAL,IAAA;QACAM,WAAA;QACAC,MAAA;QACAC,SAAA;QACAC,UAAA;QACAC,EAAA;MACA;IACA;EACA;EAEAC,KAAA;IACA;MACAC,QAAA;QAAA,QAAAV;MAAA;MACAW,OAAA;MACAC,KAAA;MACAC,UAAA,EAAApB,GAAA,CAAAqB,MAAA,GAAAC,KAAA;QACAjB,IAAA,EAAAL,GAAA,CAAAuB,MAAA,GAAAC,QAAA;QACAb,WAAA,EAAAX,GAAA,CAAAuB,MAAA,GAAAE,QAAA;QACAb,MAAA,EAAAZ,GAAA,CAAAuB,MAAA,GAAAG,KAAA,4BAAAhB,OAAA;QACAG,SAAA,EAAAb,GAAA,CAAA2B,OAAA,GAAAjB,OAAA;QACAI,UAAA,EAAAd,GAAA,CAAA4B,IAAA,GAAAH,QAAA;MACA;IACA;EACA;EAEAI,KAAA;IACAtB,WAAA;MACAuB,IAAA;MACAC,QAAAC,MAAA;QACA,KAAAf,QAAA;UAAA,GAAAe;QAAA;MACA;IACA;EACA;EAEAC,OAAA;IACA,MAAAC,SAAAC,MAAA;MACA;QACA,MAAAC,QAAA,OAAAhC,IAAA;UACAW,EAAA,OAAAE,QAAA,CAAAF,EAAA;UACAJ,WAAA,EAAAwB,MAAA,CAAAxB,WAAA;UACA0B,MAAA,EAAAF,MAAA,CAAAE;QACA;;QAEA;QACA,IAAAC,UAAA,QAAAlB,UAAA,CAAAmB,IAAA,CAAAH,QAAA;UACAI,YAAA;UACAC,MAAA;QACA;QACA,MAAAC,cAAA,OAAA7C,kBAAA;QACA,IAAA8C,QAAA;QAEA,SAAA1B,QAAA,CAAAF,EAAA;UACA;UACA,MAAA6B,iBAAA,OAAA7C,iBAAA,CAAA2C,cAAA;UACAC,QAAA,SAAAC,iBAAA,CAAAC,OAAA,CAAAP,UAAA;UACA;QACA;UACA;UACA,MAAAQ,gBAAA,OAAAhD,gBAAA,CAAA4C,cAAA;UACAC,QAAA,SAAAG,gBAAA,CAAAD,OAAA,CAAAP,UAAA;UACA;QACA;QAEA,KAAAK,QAAA,EAAAxB,KAAA;UACA,KAAAF,QAAA;YACAZ,IAAA;YACAM,WAAA;YACAC,MAAA;YACAC,SAAA;YACAC,UAAA;YACAC,EAAA;UACA;QACA;MACA,SAAAgC,GAAA;QACAC,OAAA,CAAA7B,KAAA,uCAAA4B,GAAA;QACA,KAAA5B,KAAA,GAAA4B,GAAA,CAAAE,MAAA,GAAAF,GAAA,CAAAE,MAAA,CAAAC,IAAA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}