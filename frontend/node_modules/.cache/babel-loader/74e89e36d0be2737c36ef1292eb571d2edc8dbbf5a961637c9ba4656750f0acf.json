{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport { TaskRepositoryImpl } from \"@/app/task/infrastructure/repositories/TaskRepositoryImpl\";\nimport { StoreTaskUseCase, UpdateTaskUseCase } from \"@/app/task/usecases\";\nimport axios from \"axios\";\nexport default {\n  name: \"TaskForm\",\n  props: {\n    initialData: {\n      type: Object,\n      default: () => ({\n        name: \"\",\n        description: null,\n        priority: \"low\",\n        completed: false,\n        expires_at: null,\n        id: null\n      })\n    }\n  },\n  data() {\n    return {\n      PriorityOptions: [{\n        value: null,\n        text: \"Selecciona una opcion\"\n      }, {\n        value: \"low\",\n        text: \"Baja\"\n      }, {\n        value: \"medium\",\n        text: \"Media\"\n      }, {\n        value: \"high\",\n        text: \"Alta\"\n      }],\n      formData: {\n        ...this.initialData\n      },\n      loading: false,\n      error: null,\n      backendErrors: {\n        name: \"\",\n        lastname: \"\",\n        identification: \"\",\n        email: \"\",\n        password: \"\"\n      }\n    };\n  },\n  watch: {\n    initialData: {\n      deep: true,\n      handler(newVal) {\n        this.formData = {\n          ...newVal\n        };\n      }\n    }\n  },\n  methods: {\n    async onsSubmit(values) {\n      try {\n        await axios.get(\"/sanctum/csrf-cookie\");\n        const response = await axios.post(\"/api/tasks\", this.formData);\n        this.$emit(\"task-added\", response.data);\n      } catch (err) {\n        console.error(\"Error al guardar la tarea:\", err.response?.data || err);\n      }\n    },\n    async onSubmit() {\n      try {\n        const taskRepository = new TaskRepositoryImpl();\n        let response;\n        if (this.formData.id) {\n          // Actualizar tarea existente\n          const updateTaskUseCase = new UpdateTaskUseCase(taskRepository);\n          response = await updateTaskUseCase.execute(this.formData);\n          // this.$emit(\"task-updated\", response);\n        } else {\n          // Crear nueva tarea\n          const storeTaskUseCase = new StoreTaskUseCase(taskRepository);\n          response = await storeTaskUseCase.execute(this.formData);\n          // this.$emit(\"task-added\", response);\n        }\n\n        // Limpiar formulario\n        this.formData = {\n          name: \"\",\n          description: null,\n          priority: \"low\",\n          completed: false,\n          expires_at: null\n        };\n        this.$emit(\"task-updated\", null);\n      } catch (error) {\n        if (error.response && error.response.data && error.response.data.errors) {\n          const errors = error.response.data.errors;\n          // Limpia errores anteriores\n          Object.keys(this.backendErrors).forEach(key => {\n            this.backendErrors[key] = \"\";\n          });\n          Object.entries(errors).forEach(([field, messages]) => {\n            if (Object.prototype.hasOwnProperty.call(this.backendErrors, field)) {\n              this.backendErrors[field] = messages.join(\", \");\n            }\n          });\n        }\n      }\n    }\n  }\n};","map":{"version":3,"names":["TaskRepositoryImpl","StoreTaskUseCase","UpdateTaskUseCase","axios","name","props","initialData","type","Object","default","description","priority","completed","expires_at","id","data","PriorityOptions","value","text","formData","loading","error","backendErrors","lastname","identification","email","password","watch","deep","handler","newVal","methods","onsSubmit","values","get","response","post","$emit","err","console","onSubmit","taskRepository","updateTaskUseCase","execute","storeTaskUseCase","errors","keys","forEach","key","entries","field","messages","prototype","hasOwnProperty","call","join"],"sources":["src/app/task/interfaces/presentation/components/TaskForm.vue"],"sourcesContent":["<template>\n  <validation-observer v-slot=\"{ handleSubmit }\" ref=\"formValidator\">\n    <b-form role=\"form\" @submit.prevent=\"handleSubmit(onSubmit)\">\n      <b-form-group label=\"Nombre\" label-class=\"form-control-label\">\n        <base-input\n          alternative\n          class=\"mb-3\"\n          name=\"Name\"\n          :rules=\"{ required: true }\"\n          placeholder=\"Name\"\n          v-model=\"formData.name\"\n        >\n        </base-input>\n      </b-form-group>\n\n      <div class=\"\">\n        <b-form-group label=\"Descripcion\" label-class=\"form-control-label\">\n          <!--  <label class=\"form-control-label\">About Me</label> -->\n          <b-form-textarea\n            v-model=\"formData.name\"\n            rows=\"4\"\n            value=\"\"\n            id=\"about-form-textaria\"\n            placeholder=\"Description\"\n          ></b-form-textarea>\n        </b-form-group>\n      </div>\n      <b-form-group label=\"Prioridad\" label-class=\"form-control-label\">\n        <base-input :rules=\"{ required: true }\" name=\"Priority\" Policy>\n          <b-form-select\n            v-model=\"formData.priority\"\n            :options=\"PriorityOptions\"\n          ></b-form-select>\n        </base-input>\n      </b-form-group>\n\n      <!-- <base-input name=\"Fecha de expiraciÃ³n\" :rules=\"{}\">\n        <b-form-input\n          type=\"date\"\n          v-model=\"formData.expires_at\"\n          placeholder=\"Selecciona una fecha\"\n        ></b-form-input>\n        <span class=\"text-danger\">{{ backendErrors.expires_at }}</span>\n      </base-input> -->\n      <base-input\n        type=\"date\"\n        alternative\n        class=\"mb-3\"\n        name=\"expires_at\"\n        :rules=\"{}\"\n        placeholder=\"expires_at\"\n        v-model=\"formData.expires_at\"\n      >\n      </base-input>\n\n      <b-form-group>\n        <base-input :rules=\"{}\" name=\"Completed\" Policy>\n          <b-form-checkbox v-model=\"formData.completed\">\n            <span class=\"text-muted\">Completado </span>\n          </b-form-checkbox>\n        </base-input>\n      </b-form-group>\n\n      <div class=\"text-right\">\n        <base-button type=\"secondary\" @click=\"$emit('close')\">\n          Cancelar\n        </base-button>\n        <base-button type=\"primary\" native-type=\"submit\" class=\"my-4\"\n          >Save</base-button\n        >\n      </div>\n    </b-form>\n  </validation-observer>\n</template>\n\n<script>\nimport { TaskRepositoryImpl } from \"@/app/task/infrastructure/repositories/TaskRepositoryImpl\";\nimport { StoreTaskUseCase, UpdateTaskUseCase } from \"@/app/task/usecases\";\nimport axios from \"axios\";\n\nexport default {\n  name: \"TaskForm\",\n\n  props: {\n    initialData: {\n      type: Object,\n      default: () => ({\n        name: \"\",\n        description: null,\n        priority: \"low\",\n        completed: false,\n        expires_at: null,\n        id: null,\n      }),\n    },\n  },\n\n  data() {\n    return {\n      PriorityOptions: [\n        { value: null, text: \"Selecciona una opcion\" },\n        { value: \"low\", text: \"Baja\" },\n        { value: \"medium\", text: \"Media\" },\n        { value: \"high\", text: \"Alta\" },\n      ],\n      formData: { ...this.initialData },\n      loading: false,\n      error: null,\n      backendErrors: {\n        name: \"\",\n        lastname: \"\",\n        identification: \"\",\n        email: \"\",\n        password: \"\",\n      },\n    };\n  },\n\n  watch: {\n    initialData: {\n      deep: true,\n      handler(newVal) {\n        this.formData = { ...newVal };\n      },\n    },\n  },\n\n  methods: {\n    async onsSubmit(values) {\n      try {\n        await axios.get(\"/sanctum/csrf-cookie\");\n\n        const response = await axios.post(\"/api/tasks\", this.formData);\n\n        this.$emit(\"task-added\", response.data);\n      } catch (err) {\n        console.error(\"Error al guardar la tarea:\", err.response?.data || err);\n      }\n    },\n    async onSubmit() {\n      try {\n        const taskRepository = new TaskRepositoryImpl();\n        let response;\n        if (this.formData.id) {\n          // Actualizar tarea existente\n          const updateTaskUseCase = new UpdateTaskUseCase(taskRepository);\n          response = await updateTaskUseCase.execute(this.formData);\n          // this.$emit(\"task-updated\", response);\n        } else {\n          // Crear nueva tarea\n          const storeTaskUseCase = new StoreTaskUseCase(taskRepository);\n          response = await storeTaskUseCase.execute(this.formData);\n          // this.$emit(\"task-added\", response);\n        }\n\n        // Limpiar formulario\n        this.formData = {\n          name: \"\",\n          description: null,\n          priority: \"low\",\n          completed: false,\n          expires_at: null,\n        };\n\n        this.$emit(\"task-updated\", null);\n      } catch (error) {\n        if (\n          error.response &&\n          error.response.data &&\n          error.response.data.errors\n        ) {\n          const errors = error.response.data.errors;\n          // Limpia errores anteriores\n          Object.keys(this.backendErrors).forEach((key) => {\n            this.backendErrors[key] = \"\";\n          });\n\n          Object.entries(errors).forEach(([field, messages]) => {\n            if (\n              Object.prototype.hasOwnProperty.call(this.backendErrors, field)\n            ) {\n              this.backendErrors[field] = messages.join(\", \");\n            }\n          });\n        }\n      }\n    },\n  },\n};\n</script>\n"],"mappings":";;AA4EA,SAAAA,kBAAA;AACA,SAAAC,gBAAA,EAAAC,iBAAA;AACA,OAAAC,KAAA;AAEA;EACAC,IAAA;EAEAC,KAAA;IACAC,WAAA;MACAC,IAAA,EAAAC,MAAA;MACAC,OAAA,EAAAA,CAAA;QACAL,IAAA;QACAM,WAAA;QACAC,QAAA;QACAC,SAAA;QACAC,UAAA;QACAC,EAAA;MACA;IACA;EACA;EAEAC,KAAA;IACA;MACAC,eAAA,GACA;QAAAC,KAAA;QAAAC,IAAA;MAAA,GACA;QAAAD,KAAA;QAAAC,IAAA;MAAA,GACA;QAAAD,KAAA;QAAAC,IAAA;MAAA,GACA;QAAAD,KAAA;QAAAC,IAAA;MAAA,EACA;MACAC,QAAA;QAAA,QAAAb;MAAA;MACAc,OAAA;MACAC,KAAA;MACAC,aAAA;QACAlB,IAAA;QACAmB,QAAA;QACAC,cAAA;QACAC,KAAA;QACAC,QAAA;MACA;IACA;EACA;EAEAC,KAAA;IACArB,WAAA;MACAsB,IAAA;MACAC,QAAAC,MAAA;QACA,KAAAX,QAAA;UAAA,GAAAW;QAAA;MACA;IACA;EACA;EAEAC,OAAA;IACA,MAAAC,UAAAC,MAAA;MACA;QACA,MAAA9B,KAAA,CAAA+B,GAAA;QAEA,MAAAC,QAAA,SAAAhC,KAAA,CAAAiC,IAAA,oBAAAjB,QAAA;QAEA,KAAAkB,KAAA,eAAAF,QAAA,CAAApB,IAAA;MACA,SAAAuB,GAAA;QACAC,OAAA,CAAAlB,KAAA,+BAAAiB,GAAA,CAAAH,QAAA,EAAApB,IAAA,IAAAuB,GAAA;MACA;IACA;IACA,MAAAE,SAAA;MACA;QACA,MAAAC,cAAA,OAAAzC,kBAAA;QACA,IAAAmC,QAAA;QACA,SAAAhB,QAAA,CAAAL,EAAA;UACA;UACA,MAAA4B,iBAAA,OAAAxC,iBAAA,CAAAuC,cAAA;UACAN,QAAA,SAAAO,iBAAA,CAAAC,OAAA,MAAAxB,QAAA;UACA;QACA;UACA;UACA,MAAAyB,gBAAA,OAAA3C,gBAAA,CAAAwC,cAAA;UACAN,QAAA,SAAAS,gBAAA,CAAAD,OAAA,MAAAxB,QAAA;UACA;QACA;;QAEA;QACA,KAAAA,QAAA;UACAf,IAAA;UACAM,WAAA;UACAC,QAAA;UACAC,SAAA;UACAC,UAAA;QACA;QAEA,KAAAwB,KAAA;MACA,SAAAhB,KAAA;QACA,IACAA,KAAA,CAAAc,QAAA,IACAd,KAAA,CAAAc,QAAA,CAAApB,IAAA,IACAM,KAAA,CAAAc,QAAA,CAAApB,IAAA,CAAA8B,MAAA,EACA;UACA,MAAAA,MAAA,GAAAxB,KAAA,CAAAc,QAAA,CAAApB,IAAA,CAAA8B,MAAA;UACA;UACArC,MAAA,CAAAsC,IAAA,MAAAxB,aAAA,EAAAyB,OAAA,CAAAC,GAAA;YACA,KAAA1B,aAAA,CAAA0B,GAAA;UACA;UAEAxC,MAAA,CAAAyC,OAAA,CAAAJ,MAAA,EAAAE,OAAA,GAAAG,KAAA,EAAAC,QAAA;YACA,IACA3C,MAAA,CAAA4C,SAAA,CAAAC,cAAA,CAAAC,IAAA,MAAAhC,aAAA,EAAA4B,KAAA,GACA;cACA,KAAA5B,aAAA,CAAA4B,KAAA,IAAAC,QAAA,CAAAI,IAAA;YACA;UACA;QACA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}